[{"content":"基础  通过Excel VBA编写特殊用途的函数，可以更方便地处理数据，提高效率。一般使用VBA中的Function来定义函数（Sub 不能提供返回值），即使含有自定义函数计算结果的xls文件在未安装自定义函数的电脑上打开，任然会正确显示结果，只是不能继续运算。\n 如何插入自定义的函数  新建Excel表格，（最好关闭别的Excel表），按alt + F11，点击插入，模块，添加代码。\n Function示例 1 2 3 4  \u0026#39;Function 函数名(参数 As 类型) As 函数返回类型 Function Kelvin(temperature As Double) As Double Kelvin = temperature + 273.15 End Function   获取元素分子量 部分 完整  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38  Function GETMOLES(name) \u0026#39;author: zhaoqiu  Dim Formula(124) As String Formula(0) = \u0026#34;SiO2\u0026#34; Formula(1) = \u0026#34;TiO2\u0026#34; Formula(2) = \u0026#34;Al2O3\u0026#34; \u0026#39; ... ...  Formula(122) = \u0026#34;NH3\u0026#34; Formula(123) = \u0026#34;NH4\u0026#34; Formula(124) = \u0026#34;NH4NO3\u0026#34; Dim MolecularWeight(124) As Double MolecularWeight(0) = 60.0843 MolecularWeight(1) = 79.8988 MolecularWeight(2) = 101.96128 \u0026#39; ... ...  MolecularWeight(122) = 17.0304 MolecularWeight(123) = 18.0383 MolecularWeight(124) = 80.0432 Dim oxideN As Long oxideN = UBound(Formula) - LBound(Formula) + 1 Dim i As Long Dim result As Double result = -1 For i = 0 To (oxideN - 1) If UCase(Trim(name)) = UCase(Formula(i)) Then result = MolecularWeight(i) Exit For Else End If Next If result = -1 Then GETMOLES = -1 Else GETMOLES = result End If End Function       All codes  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275  Function GETMOLES(name) \u0026#39;author: zhaoqiu  Dim Formula(124) As String Formula(0) = \u0026#34;SiO2\u0026#34; Formula(1) = \u0026#34;TiO2\u0026#34; Formula(2) = \u0026#34;Al2O3\u0026#34; Formula(3) = \u0026#34;Cr2O3\u0026#34; Formula(4) = \u0026#34;Fe2O3\u0026#34; Formula(5) = \u0026#34;FeO\u0026#34; Formula(6) = \u0026#34;MnO\u0026#34; Formula(7) = \u0026#34;MgO\u0026#34; Formula(8) = \u0026#34;CaO\u0026#34; Formula(9) = \u0026#34;Na2O\u0026#34; Formula(10) = \u0026#34;K2O\u0026#34; Formula(11) = \u0026#34;H2O\u0026#34; Formula(12) = \u0026#34;NiO\u0026#34; Formula(13) = \u0026#34;ZrO2\u0026#34; Formula(14) = \u0026#34;HfO2\u0026#34; Formula(15) = \u0026#34;H\u0026#34; Formula(16) = \u0026#34;He\u0026#34; Formula(17) = \u0026#34;Li\u0026#34; Formula(18) = \u0026#34;Be\u0026#34; Formula(19) = \u0026#34;B\u0026#34; Formula(20) = \u0026#34;C\u0026#34; Formula(21) = \u0026#34;N\u0026#34; Formula(22) = \u0026#34;O\u0026#34; Formula(23) = \u0026#34;F\u0026#34; Formula(24) = \u0026#34;Ne\u0026#34; Formula(25) = \u0026#34;Na\u0026#34; Formula(26) = \u0026#34;Mg\u0026#34; Formula(27) = \u0026#34;Al\u0026#34; Formula(28) = \u0026#34;Si\u0026#34; Formula(29) = \u0026#34;P\u0026#34; Formula(30) = \u0026#34;S\u0026#34; Formula(31) = \u0026#34;Cl\u0026#34; Formula(32) = \u0026#34;Ar\u0026#34; Formula(33) = \u0026#34;K\u0026#34; Formula(34) = \u0026#34;Ca\u0026#34; Formula(35) = \u0026#34;Sc\u0026#34; Formula(36) = \u0026#34;Ti\u0026#34; Formula(37) = \u0026#34;V\u0026#34; Formula(38) = \u0026#34;Cr\u0026#34; Formula(39) = \u0026#34;Mn\u0026#34; Formula(40) = \u0026#34;Fe\u0026#34; Formula(41) = \u0026#34;Co\u0026#34; Formula(42) = \u0026#34;Ni\u0026#34; Formula(43) = \u0026#34;Cu\u0026#34; Formula(44) = \u0026#34;Zn\u0026#34; Formula(45) = \u0026#34;Ga\u0026#34; Formula(46) = \u0026#34;Ge\u0026#34; Formula(47) = \u0026#34;As\u0026#34; Formula(48) = \u0026#34;Se\u0026#34; Formula(49) = \u0026#34;Br\u0026#34; Formula(50) = \u0026#34;Kr\u0026#34; Formula(51) = \u0026#34;Rb\u0026#34; Formula(52) = \u0026#34;Sr\u0026#34; Formula(53) = \u0026#34;Y\u0026#34; Formula(54) = \u0026#34;Zr\u0026#34; Formula(55) = \u0026#34;Nb\u0026#34; Formula(56) = \u0026#34;Mo\u0026#34; Formula(57) = \u0026#34;Tc\u0026#34; Formula(58) = \u0026#34;Ru\u0026#34; Formula(59) = \u0026#34;Rh\u0026#34; Formula(60) = \u0026#34;Pd\u0026#34; Formula(61) = \u0026#34;Ag\u0026#34; Formula(62) = \u0026#34;Cd\u0026#34; Formula(63) = \u0026#34;In\u0026#34; Formula(64) = \u0026#34;Sn\u0026#34; Formula(65) = \u0026#34;Sb\u0026#34; Formula(66) = \u0026#34;Te\u0026#34; Formula(67) = \u0026#34;I\u0026#34; Formula(68) = \u0026#34;Xe\u0026#34; Formula(69) = \u0026#34;Cs\u0026#34; Formula(70) = \u0026#34;Ba\u0026#34; Formula(71) = \u0026#34;La\u0026#34; Formula(72) = \u0026#34;Ce\u0026#34; Formula(73) = \u0026#34;Pr\u0026#34; Formula(74) = \u0026#34;Nd\u0026#34; Formula(75) = \u0026#34;Pm\u0026#34; Formula(76) = \u0026#34;Sm\u0026#34; Formula(77) = \u0026#34;Eu\u0026#34; Formula(78) = \u0026#34;Gd\u0026#34; Formula(79) = \u0026#34;Tb\u0026#34; Formula(80) = \u0026#34;Dy\u0026#34; Formula(81) = \u0026#34;Ho\u0026#34; Formula(82) = \u0026#34;Er\u0026#34; Formula(83) = \u0026#34;Tm\u0026#34; Formula(84) = \u0026#34;Yb\u0026#34; Formula(85) = \u0026#34;Lu\u0026#34; Formula(86) = \u0026#34;Hf\u0026#34; Formula(87) = \u0026#34;Ta\u0026#34; Formula(88) = \u0026#34;W\u0026#34; Formula(89) = \u0026#34;Re\u0026#34; Formula(90) = \u0026#34;Os\u0026#34; Formula(91) = \u0026#34;Ir\u0026#34; Formula(92) = \u0026#34;Pt\u0026#34; Formula(93) = \u0026#34;Au\u0026#34; Formula(94) = \u0026#34;Hg\u0026#34; Formula(95) = \u0026#34;Tl\u0026#34; Formula(96) = \u0026#34;Pb\u0026#34; Formula(97) = \u0026#34;Bi\u0026#34; Formula(98) = \u0026#34;Po\u0026#34; Formula(99) = \u0026#34;At\u0026#34; Formula(100) = \u0026#34;Rn\u0026#34; Formula(101) = \u0026#34;Fr\u0026#34; Formula(102) = \u0026#34;Ra\u0026#34; Formula(103) = \u0026#34;Ac\u0026#34; Formula(104) = \u0026#34;Th\u0026#34; Formula(105) = \u0026#34;Pa\u0026#34; Formula(106) = \u0026#34;U\u0026#34; Formula(107) = \u0026#34;Np\u0026#34; Formula(108) = \u0026#34;Pu\u0026#34; Formula(109) = \u0026#34;Am\u0026#34; Formula(110) = \u0026#34;Cm\u0026#34; Formula(111) = \u0026#34;Bk\u0026#34; Formula(112) = \u0026#34;Cf\u0026#34; Formula(113) = \u0026#34;Es\u0026#34; Formula(114) = \u0026#34;Fm\u0026#34; Formula(115) = \u0026#34;Md\u0026#34; Formula(116) = \u0026#34;No\u0026#34; Formula(117) = \u0026#34;SO3\u0026#34; Formula(118) = \u0026#34;P2O5\u0026#34; Formula(119) = \u0026#34;N2\u0026#34; Formula(120) = \u0026#34;CO2\u0026#34; Formula(121) = \u0026#34;CO\u0026#34; Formula(122) = \u0026#34;NH3\u0026#34; Formula(123) = \u0026#34;NH4\u0026#34; Formula(124) = \u0026#34;NH4NO3\u0026#34; \u0026#39; molecular weight  Dim MolecularWeight(124) As Double MolecularWeight(0) = 60.0843 MolecularWeight(1) = 79.8988 MolecularWeight(2) = 101.96128 MolecularWeight(3) = 151.9902 MolecularWeight(4) = 159.6922 MolecularWeight(5) = 71.8464 MolecularWeight(6) = 70.9374 MolecularWeight(7) = 40.3044 MolecularWeight(8) = 56.0794 MolecularWeight(9) = 61.97894 MolecularWeight(10) = 94.196 MolecularWeight(11) = 18.0152 MolecularWeight(12) = 74.6994 MolecularWeight(13) = 123.218 MolecularWeight(14) = 210.49 MolecularWeight(15) = 1.0079 MolecularWeight(16) = 4.0026 MolecularWeight(17) = 6.941 MolecularWeight(18) = 9.01218 MolecularWeight(19) = 10.81 MolecularWeight(20) = 12.011 MolecularWeight(21) = 14.0067 MolecularWeight(22) = 15.9994 MolecularWeight(23) = 18.998403 MolecularWeight(24) = 20.179 MolecularWeight(25) = 22.98977 MolecularWeight(26) = 24.305 MolecularWeight(27) = 26.98154 MolecularWeight(28) = 28.0855 MolecularWeight(29) = 30.97376 MolecularWeight(30) = 32.06 MolecularWeight(31) = 35.453 MolecularWeight(32) = 39.948 MolecularWeight(33) = 39.0983 MolecularWeight(34) = 40.08 MolecularWeight(35) = 44.9559 MolecularWeight(36) = 47.9 MolecularWeight(37) = 50.9415 MolecularWeight(38) = 51.996 MolecularWeight(39) = 54.938 MolecularWeight(40) = 55.847 MolecularWeight(41) = 58.9332 MolecularWeight(42) = 58.7 MolecularWeight(43) = 63.546 MolecularWeight(44) = 65.38 MolecularWeight(45) = 69.72 MolecularWeight(46) = 72.59 MolecularWeight(47) = 74.9216 MolecularWeight(48) = 78.96 MolecularWeight(49) = 79.904 MolecularWeight(50) = 83.8 MolecularWeight(51) = 85.4678 MolecularWeight(52) = 87.62 MolecularWeight(53) = 88.9059 MolecularWeight(54) = 91.22 MolecularWeight(55) = 92.9064 MolecularWeight(56) = 95.94 MolecularWeight(57) = 98 MolecularWeight(58) = 101.07 MolecularWeight(59) = 102.9055 MolecularWeight(60) = 106.4 MolecularWeight(61) = 107.868 MolecularWeight(62) = 112.41 MolecularWeight(63) = 114.82 MolecularWeight(64) = 118.69 MolecularWeight(65) = 121.75 MolecularWeight(66) = 127.6 MolecularWeight(67) = 126.9045 MolecularWeight(68) = 131.3 MolecularWeight(69) = 132.9054 MolecularWeight(70) = 137.33 MolecularWeight(71) = 138.9055 MolecularWeight(72) = 140.12 MolecularWeight(73) = 140.9077 MolecularWeight(74) = 144.24 MolecularWeight(75) = 145 MolecularWeight(76) = 150.4 MolecularWeight(77) = 151.96 MolecularWeight(78) = 157.25 MolecularWeight(79) = 158.9254 MolecularWeight(80) = 162.5 MolecularWeight(81) = 164.9304 MolecularWeight(82) = 167.26 MolecularWeight(83) = 168.9342 MolecularWeight(84) = 173.04 MolecularWeight(85) = 174.967 MolecularWeight(86) = 178.49 MolecularWeight(87) = 180.9479 MolecularWeight(88) = 183.85 MolecularWeight(89) = 186.207 MolecularWeight(90) = 190.2 MolecularWeight(91) = 192.22 MolecularWeight(92) = 195.09 MolecularWeight(93) = 196.9665 MolecularWeight(94) = 200.59 MolecularWeight(95) = 204.37 MolecularWeight(96) = 207.2 MolecularWeight(97) = 208.9804 MolecularWeight(98) = 209 MolecularWeight(99) = 210 MolecularWeight(100) = 222 MolecularWeight(101) = 223 MolecularWeight(102) = 226.0254 MolecularWeight(103) = 227.0278 MolecularWeight(104) = 232.0381 MolecularWeight(105) = 231.0359 MolecularWeight(106) = 238.029 MolecularWeight(107) = 237.0482 MolecularWeight(108) = 244 MolecularWeight(109) = 243 MolecularWeight(110) = 247 MolecularWeight(111) = 247 MolecularWeight(112) = 251 MolecularWeight(113) = 252 MolecularWeight(114) = 257 MolecularWeight(115) = 258 MolecularWeight(116) = 259 MolecularWeight(117) = 80.0582 MolecularWeight(118) = 141.94452 MolecularWeight(119) = 28.0134 MolecularWeight(120) = 44.0098 MolecularWeight(121) = 28.0104 MolecularWeight(122) = 17.0304 MolecularWeight(123) = 18.0383 MolecularWeight(124) = 80.0432 \u0026#39; UBound 返回数组最大下标 LBound 返回数组的最小下标即0  Dim oxideN As Long oxideN = UBound(Formula) - LBound(Formula) + 1 Dim i As Long Dim result As Double result = -1 For i = 0 To (oxideN - 1) \u0026#39; 将所有字符串转换成大写  If UCase(Trim(name)) = UCase(Formula(i)) Then result = MolecularWeight(i) Exit For Else End If Next If result = -1 Then GETMOLES = -1 Else GETMOLES = result End If End Function         'use strict'; var containerId = JSON.parse(\"\\\"9b11bf778e1f4bb2\\\"\"); var containerElem = document.getElementById(containerId); var tabLinks = null; var tabContents = null; var ids = []; if (containerElem) { tabLinks = containerElem.querySelectorAll('.tab__link'); tabContents = containerElem.querySelectorAll('.tab__content'); } for (var i = 0; i 0) { tabContents[0].style.display = 'block'; }  去除从ScienceDirect网页上直接复制的数据的非数字格式  搜集文献数据的时候，如果文献没有提供单独的excel文件，最佳的复制数据的方式是从文献对应的网页版上复制，但ScienceDirect上的页面是经过特殊渲染过的，比如负号-并不是真正的负号，另外类似-11.63(221), 58.5 ± 2·3等数据+误差的格式也需要后续处理。\n   All codes  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98  Function GETNUMBER(text) temptext = text text = Trim(text) If Len(text) \u0026gt; 0 Then If Not IsNumeric(text) Then \u0026#39; 常见格式：2.48(5) 2.48 (5) 2.48 ±2 3·52? 2.48(5) 1,000  \u0026#39; 区分需要替换的符号和去除的符号  \u0026#39; 需要去除的  Dim BlankIndex As Long BlankIndex = InStr(1, text, \u0026#34; \u0026#34;) If BlankIndex = 0 Then BlankIndex = 100000 End If Dim LeftBracketIndex As Long LeftBracketIndex = InStr(1, text, \u0026#34;(\u0026#34;) If LeftBracketIndex = 0 Then LeftBracketIndex = 100000 End If Dim RightBracketIndex As Long RightBracketIndex = InStr(1, text, \u0026#34;)\u0026#34;) If RightBracketIndex = 0 Then RightBracketIndex = 100000 End If Dim QuestionMarkIndex As Long QuestionMarkIndex = InStr(1, text, \u0026#34;?\u0026#34;) If QuestionMarkIndex = 0 Then QuestionMarkIndex = 100000 End If Dim PlusMinusIndex As Long PlusMinusIndex = InStr(1, text, \u0026#34;±\u0026#34;) If PlusMinusIndex = 0 Then PlusMinusIndex = 100000 End If minindex = WorksheetFunction.Min(BlankIndex, LeftBracketIndex, RightBracketIndex, QuestionMarkIndex, PlusMinusIndex) If minindex \u0026lt; 100000 Then text = Left(text, minindex - 1) End If \u0026#39; 需要替换的  Dim DotIndex As Long DotIndex = InStr(1, text, \u0026#34;·\u0026#34;) If Not DotIndex = 0 Then text = Replace(text, \u0026#34;·\u0026#34;, \u0026#34;.\u0026#34;, 1, 1) End If Dim CommaIndex As Long CommaIndex = InStr(1, text, \u0026#34;,\u0026#34;) If Not CommaIndex = 0 Then text = Replace(text, \u0026#34;,\u0026#34;, \u0026#34;\u0026#34;, 1, 1) End If If Val(text) = 0 Then If Len(text) \u0026gt; 1 Then If (Asc(Left(text, 1)) \u0026gt;= 65 And Asc(Left(text, 1)) \u0026lt;= 90) Or (Asc(Left(text, 1)) \u0026gt;= 97 And Asc(Left(text, 1)) \u0026lt;= 122) Then GETNUMBER = temptext Else GETNUMBER = Val(\u0026#34;-\u0026#34; \u0026amp; Right(text, Len(text) - 1)) End If Else GETNUMBER = temptext End If Else GETNUMBER = Val(text) End If Else GETNUMBER = Val(text) End If End If End Function      提取误差  待完成\n ","description":"开发Excel插件","id":0,"section":"posts","tags":["Excel","分子量","提取"],"title":"自定义Excel函数","uri":"https://mayan-lab.github.io/zh/posts/customizing-excel-function/"},{"content":" 八大行星的名字都来源于 罗马诸神 ，这些名字都蕴含了对应行星的特点。\n Solar system1 Mercury：命名于罗马信使神，他脚上有翅膀，有着出了名的移动速度。\nVenus：命名于爱与美的女神。金星是天空中亮度仅次于太阳和月亮的星球，她是天空中永恒的美景。\nEarth: 和其他行星不同，地球并不是源于古罗马的某个神。\nMars：罗马战神。红色是鲜血与战争的颜色，而火星就是一颗红色的星球。这种红色是源于他土壤的一种锈迹。\nJupiter：古罗马的至高神。太阳系最大的行星是木星，因此他被命名为诸神之王。\nSaturn：他是在Jupiter之前统治世界的泰坦神王，同时也是农业之神。Saturn占据着天空最重要的地方，拥有着超过30个月球大的体积。\nUranus：最初的罗马天空之神。\nNeptune：命名于罗马海洋之神。很多年以前，海王星被认为运行在太阳系的边界，守卫着整个辽阔的宇宙海洋。\nPluto：地狱之神。地狱的黑暗和寒冷正如人们看到的冥王星那样。\n soloar system wiki \u0026#x21a9;\u0026#xfe0e;\n   ","description":"Mercury, Venus, Earth, Mars Jupiter, Saturn, Uranus, Neptune","id":1,"section":"posts","tags":["planet","astronomy"],"title":"行星名称起源","uri":"https://mayan-lab.github.io/zh/posts/planet-name-origins/"},{"content":"基本配置 同时在win和mac上部署了hugo，都使用了Webstorm，本来打算借助Webstorm对Git的集成的优势，但使用下来体验并不好，最后还是在Webstorm中的Terminal中进行git。\n1 2 3 4 5 6 7 8 9 10  cd public git init git remote add origin git@github.com:/\u0026lt;github_username\u0026gt;/\u0026lt;github_username\u0026gt;.github.io.git git add . git commit -m \u0026#34;some message\u0026#34; # -u表示以后可以仅使用git push进行上传 git push -u origin master # 新机器同步仓库 拷贝其他不需要同步的文件时注意删除.git隐藏文件夹 git pull origin master   1 2 3 4 5 6 7 8 9 10 11 12 13 14  # hugo command # 启动本地server hugo server -D # 新建站点 hugo new site sitename # 在已存在的文件夹下强制创建 hugo new site sitename --force # 新建文章 hugo new posts/my-post.md # 构建项目 在根目录下运行 hugo   百度不收录Github Page 首先尝试zeit.co提供的免费CDN，但百度仍然不能正常抓取,抓取测试提示308错误，而且不能认证为https，原因现在还没找到。另外，Gitlab Page也可以考虑，但是，gitlab并不是提交hugo构建后的静态文件，而是接受原资源，进而在其服务器里自动构建，要想更便捷的同时同步Github和Gitlab的Page内容并不容易。\n插入自定义js, css custom_css = [ ] # custom_css = [\"scss/custom.scss\"] root/assets/scss/custom.scss custom_js = [ ] # custom_js = [\"js/custom.js\"] root/assets/js/custom.js   通过尝试加入去除链接下的下划线的css文件，发现并没有起作用。 计划通过加入typescript编译过后的js文件以及d3js与Github page结合，封装一些d3js绘图的模块。  ","description":"记录使用到的Hugo和github page的功能","id":2,"section":"posts","tags":["hugo"],"title":"第一篇文章：记录使用到的Hugo的功能","uri":"https://mayan-lab.github.io/zh/posts/first-page/"},{"content":"分享日常工作 相关代码 ","description":"","id":4,"section":"about","tags":null,"title":"About","uri":"https://mayan-lab.github.io/zh/about/about/"}]